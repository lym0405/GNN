â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Phase 2: Static Graph Embedding                   â•‘
â•‘                         ì „ì²´ êµ¬ì¡° ë° ì‹¤í–‰ ê°€ì´ë“œ                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Phase 2 ê°œìš”                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ëª©í‘œ: Phase 1ì˜ ë ˆì‹œí”¼ + ì¬ë¬´/TIS ì •ë³´ë¥¼ ê²°í•©í•˜ì—¬ GraphSAGEë¡œ ì„ë² ë”© í•™ìŠµ

ì…ë ¥:
  - disentangled_recipes.pkl (Phase 1 ì¶œë ¥)
  - ë§¤ì¶œ/ìˆ˜ì¶œ/ìì‚° ë°ì´í„°
  - TIS ë¦¬ìŠ¤í¬ ì ìˆ˜
  - H í–‰ë ¬ (ê±°ë˜ ë„¤íŠ¸ì›Œí¬)

ì¶œë ¥:
  - node_embeddings_static.pt (NÃ—32 ì„ë² ë”©)
  - train_edges.npy (í•™ìŠµìš© ì—£ì§€, 80%)
  - test_edges.npy (í‰ê°€ìš© ì—£ì§€, 20%)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. í”¼ì²˜ êµ¬ì¡° (197ì°¨ì›)                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ì¬ë¬´ í”¼ì²˜: 4ì°¨ì›]
  - log(ë§¤ì¶œ + 1)
  - log(ìˆ˜ì¶œì•¡ + 1)
  - log(ìì‚° + 1)
  - ìˆ˜ì¶œ/ë§¤ì¶œ ë¹„ìœ¨

[ì§€ë¦¬ í”¼ì²˜: 2ì°¨ì›]
  - ìœ„ë„
  - ê²½ë„

[ë¦¬ìŠ¤í¬ í”¼ì²˜: 1ì°¨ì›]
  - TIS ì •ê·œí™” ì ìˆ˜

[ì‚°ì—… í”¼ì²˜: 157ì°¨ì›]
  - ì‚°ì—…ì½”ë“œ One-Hot (33ì°¨ì›)
  - ì‚°ì—…ì½”ë“œ Embedding (124ì°¨ì›, ì„ íƒì )
  ë˜ëŠ” ê·¸ëƒ¥ 33ì°¨ì›ë§Œ ì‚¬ìš©

[ë ˆì‹œí”¼ í”¼ì²˜: 33ì°¨ì›]
  - Phase 1ì˜ ìƒì‚°í•¨ìˆ˜ ë²¡í„°

ì´í•©: 4 + 2 + 1 + 33 + 33 = 73ì°¨ì› (ê°„ì†Œí™” ë²„ì „)
     4 + 2 + 1 + 157 + 33 = 197ì°¨ì› (ì „ì²´ ë²„ì „)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ì»¤ë¦¬í˜ëŸ¼ í•™ìŠµ ì „ëµ (Easy â†’ Hard) ğŸ†•                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Epoch 1-20: Easy Phase (Random Negative ìœ„ì£¼)
  â”œâ”€ Positive : Random Negative = 1 : 9
  â””â”€ Historical Hard Negative = 0

Epoch 21-50: Medium Phase (Historical ì¡°ê¸ˆ ì¶”ê°€)
  â”œâ”€ Positive : Random Negative : Historical = 1 : 7 : 2
  â””â”€ Hard Negative ë¹„ìœ¨ 20%

Epoch 51-55: Hard Phase (Historical ë” ì¶”ê°€)
  â”œâ”€ Positive : Random Negative : Historical = 1 : 5 : 4
  â””â”€ Hard Negative ë¹„ìœ¨ 40%

Epoch 56-60: Final Phase (ì•ˆì •í™”)
  â”œâ”€ Positive : Random Negative : Historical = 1 : 6 : 3
  â””â”€ Hard Negative ë¹„ìœ¨ 30% (ì•ˆì •í™”)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ë„¤ê±°í‹°ë¸Œ ìƒ˜í”Œë§ ìƒì„¸                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Random Negative (Easy):
  - ì™„ì „ ëœë¤ ê¸°ì—… ìŒ
  - ì—°ê²°ë˜ì§€ ì•Šì€ ë…¸ë“œ ì¤‘ ë¬´ì‘ìœ„ ì„ íƒ
  - í•™ìŠµ ì´ˆë°˜ ëª¨ë¸ ì•ˆì •í™”ì— ìœ ë¦¬

Historical Hard Negative (Hard):
  - 2020-2023ë…„ì—ëŠ” ê±°ë˜í–ˆì§€ë§Œ 2024ë…„ì—ëŠ” ë‹¨ì ˆëœ ê´€ê³„
  - "ê³¼ê±°ì—ëŠ” ì—°ê²°, í˜„ì¬ëŠ” ì•„ë‹˜" â†’ ì–´ë ¤ìš´ ì¼€ì´ìŠ¤
  - ë¹„ìœ¨ì„ ì ì§„ì ìœ¼ë¡œ ì¦ê°€ (0% â†’ 20% â†’ 40% â†’ 30%)

TIS-weighted Sampling (ì„ íƒì ):
  - TISê°€ ë‚®ì€ ê¸°ì—…ì„ negativeë¡œ ì„ íƒí•  í™•ë¥  ë†’ì„
  - ë¦¬ìŠ¤í¬ íšŒí”¼ í•™ìŠµ ê°•í™”

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Data Leakage ë°©ì§€ ì „ëµ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Train/Test ì—£ì§€ ì™„ì „ ë¶„ë¦¬
  - 2024ë…„ ê±°ë˜ ì—£ì§€ë¥¼ 80/20ìœ¼ë¡œ ë¶„í•  (random_state=42)
  - Test ì—£ì§€ëŠ” í•™ìŠµì— ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

âœ… GraphSAGE í•™ìŠµ ì‹œ Train ì—£ì§€ë§Œ ì‚¬ìš©
  - Message Passingì€ Train ì—£ì§€ë¡œë§Œ ìˆ˜í–‰
  - Test ì—£ì§€ëŠ” í‰ê°€ ì‹œì—ë§Œ ë“±ì¥

âœ… Historical NegativeëŠ” 2020-2023 ë°ì´í„°ë§Œ ì‚¬ìš©
  - 2024ë…„ ì •ë³´ëŠ” ì™„ì „ ì°¨ë‹¨

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. í”„ë¡œì íŠ¸ êµ¬ì¡°                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GNN/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ graph_builder.py              # ğŸ†• ì •ì  ê·¸ë˜í”„ ë¹Œë”
â”‚   â”œâ”€â”€ sampler.py                    # ğŸ†• ì»¤ë¦¬í˜ëŸ¼ ë„¤ê±°í‹°ë¸Œ ìƒ˜í”ŒëŸ¬
â”‚   â”œâ”€â”€ GraphSAGE.py                  # ğŸ†• GraphSAGE ëª¨ë¸
â”‚   â”œâ”€â”€ loss.py                       # ğŸ†• TIS-aware BCE Loss
â”‚   â””â”€â”€ trainer.py                    # ğŸ†• ì»¤ë¦¬í˜ëŸ¼ í•™ìŠµ ë£¨í”„
â”‚
â”œâ”€â”€ main_phase2_fixed.py              # ğŸ†• ë©”ì¸ ì‹¤í–‰ íŒŒì¼
â”œâ”€â”€ PHASE2_README.md                  # ğŸ“– ìƒì„¸ ë¬¸ì„œ
â”œâ”€â”€ requirements_phase2.txt           # ğŸ“¦ íŒ¨í‚¤ì§€ ëª©ë¡
â””â”€â”€ PHASE2_STRUCTURE.txt              # ğŸ“‹ ë³¸ íŒŒì¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ì‹¤í–‰ ìˆœì„œ                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â‘  Phase 1 ì™„ë£Œ í™•ì¸:
   data/processed/disentangled_recipes.pkl ì¡´ì¬ ì—¬ë¶€

â‘¡ Phase 2 ì‹¤í–‰:
   $ python main_phase2_fixed.py

â‘¢ ì¶œë ¥ í™•ì¸:
   data/processed/
   â”œâ”€â”€ node_embeddings_static.pt      # ì„ë² ë”©
   â”œâ”€â”€ train_edges.npy                # í•™ìŠµ ì—£ì§€
   â”œâ”€â”€ test_edges.npy                 # í‰ê°€ ì—£ì§€
   â””â”€â”€ X_feature_matrix.npy           # í”¼ì²˜ í–‰ë ¬

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. í•˜ì´í¼íŒŒë¼ë¯¸í„°                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GraphSAGE:
  - hidden_dim: 64
  - output_dim: 32
  - num_layers: 2
  - dropout: 0.3
  - aggregator: 'mean'

Training:
  - epochs: 20
  - batch_size: 1024
  - learning_rate: 0.001
  - weight_decay: 1e-5

Curriculum:
  - easy_epochs: 20 (Random only)
  - medium_epochs: 30 (20% Historical)
  - hard_epochs: 5 (40% Historical)
  - final_epochs: 5 (30% Historical)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. ì˜ˆìƒ ì„±ëŠ¥                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë”ë¯¸ ë°ì´í„° (1,000 ê¸°ì—…):
  - í”¼ì²˜ ìƒì„±: ~1ì´ˆ
  - GraphSAGE í•™ìŠµ: ~30ì´ˆ (20 epochs)
  - ì´ ì‹¤í–‰ ì‹œê°„: ~40ì´ˆ

ì‹¤ì œ ë°ì´í„° (438,946 ê¸°ì—…):
  - í”¼ì²˜ ìƒì„±: ~2ë¶„
  - GraphSAGE í•™ìŠµ: ~30ë¶„ (20 epochs, GPU)
  - ì´ ì‹¤í–‰ ì‹œê°„: ~35ë¶„

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Phase 2 ì½”ë“œ ìƒì„± ì‹œì‘! ğŸš€                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
