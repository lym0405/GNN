GNN/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/  # [ì›ë³¸ ë°ì´í„°] (ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€)
â”‚   â”‚   â”œâ”€â”€ posco_network_capital_consumergoods_removed_2020.csv
â”‚   â”‚   â”œâ”€â”€ posco_network_capital_consumergoods_removed_2021.csv
â”‚   â”‚   â”œâ”€â”€ posco_network_capital_consumergoods_removed_2022.csv
â”‚   â”‚   â”œâ”€â”€ posco_network_capital_consumergoods_removed_2023.csv
â”‚   â”‚   â”œâ”€â”€ posco_network_capital_consumergoods_removed_2024.csv
â”‚   â”‚   â”‚   â†’ ì»¬ëŸ¼: ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸, ê±°ë˜ì²˜ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸, ì´ê³µê¸‰ê¸ˆì•¡ ë“±
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ H_csr_model2.npz            # ê±°ë˜ ë„¤íŠ¸ì›Œí¬ í–‰ë ¬ (Sparse, 438KÃ—438K)
â”‚   â”‚   â”œâ”€â”€ firm_to_idx_model2.csv      # ì‚¬ì—…ìë²ˆí˜¸ â†’ ì¸ë±ìŠ¤ ë§¤í•‘ (ì •ë ¬ ê¸°ì¤€)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ vat_20-24_company_list_w_companyinfo_nocutoff_v3_hyundaisteel_hj.csv
â”‚   â”‚   â”‚   â†’ ì „ì²´ ê¸°ì—… ì •ë³´ (ì—…ì²´ë²ˆí˜¸, ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸, ì¢Œí‘œ, ì‚°ì—…ì½”ë“œ)
â”‚   â”‚   â”œâ”€â”€ vat_20-24_company_list_w_companyinfo_cutoff_q1more_v3_hyundaisteel_hj.csv
â”‚   â”‚   â”‚   â†’ Q1 ì»·ì˜¤í”„ ê¸°ì—… ì •ë³´
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ A_33.csv                    # êµ­ê°€ IO í…Œì´ë¸” (33Ã—33)
â”‚   â”‚   â”œâ”€â”€ tg_2024_filtered.csv        # ë§¤ì¶œ ë°ì´í„° (ì—…ì²´ë²ˆí˜¸, tg_2024_final)
â”‚   â”‚   â”œâ”€â”€ final_tg_2024_estimation.csv # ë§¤ì¶œ ì¶”ì • (Phase 1ìš©)
â”‚   â”‚   â”œâ”€â”€ export_estimation_value_final.csv # ìˆ˜ì¶œì•¡ (ì²œì› ë‹¨ìœ„)
â”‚   â”‚   â”œâ”€â”€ asset_final_2024_6ì°¨.csv     # ìì‚° ì¶”ì •
â”‚   â”‚   â””â”€â”€ shock_after_P_v2.csv        # TIS ë¦¬ìŠ¤í¬ ì ìˆ˜
â”‚   â”‚   
â”‚   â””â”€â”€ processed/  # [ì „ì²˜ë¦¬ ê²°ê³¼ ë° ëª¨ë¸ ì¶œë ¥]
â”‚       â”œâ”€â”€ disentangled_recipes.pkl    # Phase 1: ê¸°ì—…ë³„ ìƒì‚°í•¨ìˆ˜ (33ì°¨ì›)
â”‚       â”‚
â”‚       â”œâ”€â”€ X_feature_matrix.npy        # Phase 2: í”¼ì²˜ í–‰ë ¬ (NÃ—197)
â”‚       â”œâ”€â”€ recipe_features_cache.npy   # Phase 2: ë ˆì‹œí”¼ ìºì‹± (ì†ë„ í–¥ìƒ)
â”‚       â”œâ”€â”€ tis_score_normalized.npy    # Phase 2: TIS ì •ê·œí™” ì ìˆ˜
â”‚       â”œâ”€â”€ node_embeddings_static.pt   # Phase 2: GraphSAGE ì„ë² ë”© (NÃ—32)
â”‚       â”‚
â”‚       â”œâ”€â”€ train_edges.npy             # ğŸ†• Phase 2: Train ì—£ì§€ (80%, Data Leakage ë°©ì§€)
â”‚       â”œâ”€â”€ test_edges.npy              # ğŸ†• Phase 2: Test ì—£ì§€ (20%, í‰ê°€ìš©)
â”‚       â”‚
â”‚       â”œâ”€â”€ temporal_events_cache.pt    # Track A: TGN ì‹œê³„ì—´ ì´ë²¤íŠ¸ ìºì‹œ
â”‚       â”œâ”€â”€ tgn_scores_test.npy         # Track A: TGN ì˜ˆì¸¡ ì ìˆ˜
â”‚       â”‚
â”‚       â”œâ”€â”€ final_hybrid_model_strict.pt # Phase 3: GraphSEAL í•™ìŠµ ëª¨ë¸
â”‚       â”œâ”€â”€ final_mixer_model.pt        # Phase 3: LinkMixer ì•™ìƒë¸” ëª¨ë¸
â”‚       â”‚
â”‚       â””â”€â”€ H_prime_rewired.npz         # Phase 4: ì¬ë°°ì„ ëœ ë„¤íŠ¸ì›Œí¬
â”‚
â”œâ”€â”€ src/  # [í•µì‹¬ ëª¨ë“ˆ]
â”‚   â”‚
â”‚   â”œâ”€â”€ # --- [Data Builders] ---
â”‚   â”œâ”€â”€ graph_builder.py          # âœ… ì •ì  ê·¸ë˜í”„ ë¹Œë” (ì¸ë±ìŠ¤ ì •ë ¬ ìˆ˜ì • ì™„ë£Œ)
â”‚   â”‚   â†’ build_static_data(): .reindex()ë¡œ ê°•ì œ ì •ë ¬
â”‚   â”‚   â†’ NaN ë°•ë©¸: np.nan_to_num() ì´ì¤‘ ë°©ì–´
â”‚   â”‚   â†’ ë ˆì‹œí”¼ ìºì‹±: recipe_features_cache.npy
â”‚   â”‚   â†’ TIS ë³„ë„ ì €ì¥: tis_score_normalized.npy
â”‚   â”‚
â”‚   â”œâ”€â”€ temporal_builder.py       # TGNìš© ì‹œê³„ì—´ ë°ì´í„° êµ¬ì¶•
â”‚   â”œâ”€â”€ dynamic_graph_builder.py  # ë™ì  ê·¸ë˜í”„ ì´ë²¤íŠ¸ ìƒì„±
â”‚   â”œâ”€â”€ data_prep.py              # ë°ì´í„° ë¶„í•  ë° ìƒ˜í”Œë§
â”‚   â”‚
â”‚   â”œâ”€â”€ seal_utils.py             # âœ… GraphSEAL ì„œë¸Œê·¸ë˜í”„ ì¶”ì¶œ & DRNL (ì—£ì§€ ë§ˆìŠ¤í‚¹ ì™„ë£Œ)
â”‚   â”‚   â†’ SEALDataset í´ë˜ìŠ¤
â”‚   â”‚   â†’ extract_enclosing_subgraphs()
â”‚   â”‚   â†’ ğŸ†• Target edge ë§ˆìŠ¤í‚¹: ì˜ˆì¸¡ ëŒ€ìƒ ì—£ì§€ë¥¼ ì„œë¸Œê·¸ë˜í”„ì—ì„œ ì œê±°
â”‚   â”‚
â”‚   â”œâ”€â”€ sampler.py                # âœ… ë„¤ê±°í‹°ë¸Œ ìƒ˜í”Œë§ (ì»¬ëŸ¼ëª… ìˆ˜ì • ì™„ë£Œ)
â”‚   â”‚   â†’ StanfordNegativeSampler í´ë˜ìŠ¤
â”‚   â”‚   â†’ Historical Hard Negative (2020-2023 ì´ë ¥)
â”‚   â”‚   â†’ Random Negative
â”‚   â”‚
â”‚   â”œâ”€â”€ # --- [Models] ---
â”‚   â”œâ”€â”€ GraphSAGE.py              # ì •ì  ì„ë² ë”© (2-Layer SAGEConv)
â”‚   â”œâ”€â”€ GAT.py                    # Graph Attention Network
â”‚   â”œâ”€â”€ GraphSEAL.py              # DGCNN êµ¬ì¡°ì  ë§í¬ ì˜ˆì¸¡
â”‚   â”œâ”€â”€ LinkMixer.py              # ê²½ëŸ‰ MLP ì•™ìƒë¸” ëª¨ë¸
â”‚   â”œâ”€â”€ TGN.py                    # Temporal Graph Network
â”‚   â”‚
â”‚   â”œâ”€â”€ # --- [Training & Evaluation] ---
â”‚   â”œâ”€â”€ loss.py                   # âœ… RiskAwareBCELoss
â”‚   â”‚   â†’ TIS ê¸°ë°˜ Soft Label: 1.0 - (alpha Ã— TIS)
â”‚   â”‚   â†’ ì¶œë ¥ í‚¤: avg_pos_score, avg_rand_score, avg_hist_score
â”‚   â”‚
â”‚   â”œâ”€â”€ trainer.py                # í•™ìŠµ ë£¨í”„ ê´€ë¦¬
â”‚   â”œâ”€â”€ evaluator.py              # ì•™ìƒë¸” í‰ê°€ & Robustness Test
â”‚   â”œâ”€â”€ benchmark.py              # íœ´ë¦¬ìŠ¤í‹± ë²¤ì¹˜ë§ˆí¬ (CN, AA, PA)
â”‚   â”‚
â”‚   â”œâ”€â”€ # --- [Optimization & Simulation] ---
â”‚   â”œâ”€â”€ rewiring.py               # SupplyChainOptimizer (Phase 4)
â”‚   â”œâ”€â”€ simulation.py             # ResilienceSimulator (Phase 5)
â”‚   â”‚
â”‚   â””â”€â”€ # --- [Phase 1 Utils] ---
â”‚       â”œâ”€â”€ inventory_module.py       # ZeroShotInventoryModule
â”‚       â”œâ”€â”€ b_matrix_generator.py     # âœ… BMatrixGenerator (ë³€ìˆ˜ëª… ìˆ˜ì •)
â”‚       â”‚   â†’ biz_share_map, biz_sector_map ì‚¬ìš©
â”‚       â”œâ”€â”€ check_recipe.py           # ë ˆì‹œí”¼ ê²€ì¦
â”‚       â””â”€â”€ debug_deep_dive.py        # ë””ë²„ê·¸ ë„êµ¬        
â”‚ 
â”œâ”€â”€ # [ë©”ì¸ ì‹¤í–‰ íŒŒì´í”„ë¼ì¸]
â”‚
â”œâ”€â”€ backup/                      # ë°±ì—… í´ë” (ì´ì „ ë²„ì „ ë³´ê´€)
â”‚   â”œâ”€â”€ main_phase1.py           # Phase 1 ë°±ì—…
â”‚   â”œâ”€â”€ main_phase2.py           # Phase 2 ë°±ì—… (ì›ë³¸)
â”‚   â”œâ”€â”€ main_track_A.py          # Track A ë°±ì—…
â”‚   â”œâ”€â”€ main_phase3_mixer.py     # Mixer ë°±ì—…
â”‚   â”œâ”€â”€ main_sanity_check.py     # ì§„ë‹¨ ìŠ¤í¬ë¦½íŠ¸ ë°±ì—…
â”‚   â”œâ”€â”€ debug_alignment.py       # ì •í•©ì„± ê²€ì¦ ë°±ì—…
â”‚   â””â”€â”€ check_b_vector.py        # âœ… Bë²¡í„° ê²€ì¦ (ë³€ìˆ˜ëª… ìˆ˜ì • ì™„ë£Œ)
â”‚
â”œâ”€â”€ # [í˜„ì¬ ì‹¤í–‰ íŒŒì¼] â­
â”‚
â”œâ”€â”€ main_phase2_fixed.py         # ğŸ†• Phase 2: Train/Test ë¶„ë¦¬ ë²„ì „ (Data Leakage ë°©ì§€)
â”‚   â†’ main_phase2.py êµ¬ì¡° ìœ ì§€í•˜ë©´ì„œ Train/Test ì—£ì§€ ë¶„í•  ì¶”ê°€
â”‚   â†’ Train ì—£ì§€ë§Œìœ¼ë¡œ GraphSAGE í•™ìŠµ (TestëŠ” ì™„ì „ ê²©ë¦¬)
â”‚   â†’ ì¶œë ¥: node_embeddings_static.pt, train_edges.npy, test_edges.npy
â”‚
â”œâ”€â”€ main_phase3_train.py         # âœ… Phase 3: GraphSEAL í•™ìŠµ (Data Leakage ë°©ì§€)
â”‚   â†’ Phase 2ì˜ train_edges.npyë§Œ ì‚¬ìš©í•˜ì—¬ í•™ìŠµ
â”‚   â†’ SEALDataset: Target edge ë§ˆìŠ¤í‚¹ ì ìš©
â”‚   â†’ Test ì—£ì§€ëŠ” benchmarkì—ì„œë§Œ ì‚¬ìš©
â”‚   â†’ ì¶œë ¥: final_hybrid_model_strict.pt
â”‚
â”œâ”€â”€ main_phase3_benchmark.py     # âœ… Phase 3: ë²¤ì¹˜ë§ˆí¬ í‰ê°€ (Data Leakage ë°©ì§€)
â”‚   â†’ Phase 2ì˜ test_edges.npyë¡œ ìµœì¢… í‰ê°€
â”‚   â†’ Common Neighbors, Adamic-Adar ë“±
â”‚   â†’ GraphSEAL ì„±ëŠ¥ ë¹„êµ
â”‚   â†’ Leaderboard ì¶œë ¥
â”‚
â”œâ”€â”€ verify_no_leakage.py         # ğŸ†• Data Leakage ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
â”‚   â†’ CHECK 1: Train/Test ì—£ì§€ Overlap í™•ì¸
â”‚   â†’ CHECK 2: SEALDataset ì—£ì§€ ë§ˆìŠ¤í‚¹ í™•ì¸
â”‚   â†’ CHECK 3: Zero Embedding AUC í…ŒìŠ¤íŠ¸ (í•µì‹¬!)
â”‚   â†’ CHECK 4: Hard Negatives AUC í…ŒìŠ¤íŠ¸
â”‚
â”œâ”€â”€ verify_data_leakage.py       # ğŸ†• Data Leakage ìë™ ê²€ì¦ (ìƒì„¸ ë²„ì „)
â”‚   â†’ verify_no_leakage.pyì™€ ë™ì¼í•œ ê¸°ëŠ¥
â”‚   â†’ ì¶”ê°€ í†µê³„ ë° ìƒì„¸ ë¦¬í¬íŠ¸
â”‚
â”œâ”€â”€ VERIFICATION_GUIDE.txt       # ğŸ†• ê²€ì¦ ê°€ì´ë“œ ë¬¸ì„œ
â”‚   â†’ ì‹¤í–‰ ìˆœì„œ, í•´ì„ ë°©ë²•, ì£¼ì˜ì‚¬í•­
â”‚
â”œâ”€â”€ LEAKAGE_FIXES_SUMMARY.txt    # ğŸ†• Data Leakage ìˆ˜ì • ìš”ì•½
â”‚   â†’ 4ê°€ì§€ ì²´í¬ í•­ëª©ë³„ ìˆ˜ì • ë‚´ìš©
â”‚
â”œâ”€â”€ main_phase4.py               # Phase 4: ê³µê¸‰ë§ ì¬ë°°ì„ 
â”‚   â†’ SupplyChainOptimizer ì‚¬ìš©
â”‚   â†’ ë‹¨ì ˆ ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜
â”‚   â†’ ìµœì  ëŒ€ì²´ ê³µê¸‰ì ì¶”ì²œ
â”‚   â†’ ì¶œë ¥: H_prime_rewired.npz
â”‚
â”œâ”€â”€ main_phase5.py               # Phase 5: ë¦¬ì§ˆë¦¬ì–¸ìŠ¤ ê²€ì¦
â”‚   â†’ ResilienceSimulator ì‚¬ìš©
â”‚   â†’ H vs H' ì¶©ê²© ì „íŒŒ ë¹„êµ
â”‚   â†’ Economic Loss ê³„ì‚°
â”‚   â†’ Delta Output ë¶„ì„
â”‚
â”œâ”€â”€ columns                      # ë°ì´í„° ëª…ì„¸ì„œ (í…ìŠ¤íŠ¸)
â””â”€â”€ structure                    # í”„ë¡œì íŠ¸ êµ¬ì¡° ë¬¸ì„œ (ë³¸ íŒŒì¼)

# ============================================================
# ì „ì²´ ì‹¤í–‰ í”Œë¡œìš° (2026.01.18 ìµœì‹ )
# ============================================================

[Phase 1] ìƒì‚°í•¨ìˆ˜ ì¶”ì • (backup/main_phase1.py)
  ì…ë ¥: IO í…Œì´ë¸”, H í–‰ë ¬, ê¸°ì—…ì •ë³´, ë§¤ì¶œ, ê±°ë˜ ë°ì´í„°
  ì²˜ë¦¬: BMatrixGenerator â†’ ZeroShotInventoryModule
  ì¶œë ¥: disentangled_recipes.pkl (ê¸°ì—…ë³„ 33ì°¨ì› ìƒì‚°í•¨ìˆ˜)
  
[Phase 2] ì •ì  ì„ë² ë”© (main_phase2_fixed.py) ğŸ†• Data Leakage ë°©ì§€ ë²„ì „
  ì…ë ¥: Phase 1 ì¶œë ¥ + ë§¤ì¶œ/ìˆ˜ì¶œ/ìì‚°/TIS + H í–‰ë ¬
  ì²˜ë¦¬: 
    - graph_builder.py: ì¸ë±ìŠ¤ ì •ë ¬ (.reindex)
    - í”¼ì²˜ ìƒì„± (197ì°¨ì›): ì¬ë¬´4 + ì¢Œí‘œ2 + TIS1 + ì‚°ì—…ë¶„ë¥˜ + ë ˆì‹œí”¼33
    - ğŸ†• Train/Test ì—£ì§€ ë¶„í•  (80/20, random_state=42)
    - GraphSAGE í•™ìŠµ (Curriculum: Easyâ†’Hard) - Train ì—£ì§€ë§Œ ì‚¬ìš©!
    - sampler.py: 1:1 â†’ 1:9:9 ë„¤ê±°í‹°ë¸Œ ìƒ˜í”Œë§
    - loss.py: TIS ê¸°ë°˜ Soft Label
  ì¶œë ¥: 
    - node_embeddings_static.pt (NÃ—32)
    - train_edges.npy (í•™ìŠµìš©, 80%)
    - test_edges.npy (í‰ê°€ìš©, 20%)
  
[Track A] ë™ì  ì„ë² ë”© (backup/main_track_A.py) - ì„ íƒì 
  ì…ë ¥: ì‹œê³„ì—´ ê±°ë˜ ë°ì´í„° (2020-2023, 2024ë…„ ì œì™¸)
  ìºì‹œ: temporal_events_cache.pt
  ì²˜ë¦¬: TGN Memory ëª¨ë“ˆ
  ì¶œë ¥: tgn_scores_test.npy

[Phase 3] Link Prediction (main_phase3_train.py + main_phase3_benchmark.py) ğŸ†•
  ì…ë ¥: Phase 2 ì„ë² ë”© + train_edges.npy + test_edges.npy
  ì²˜ë¦¬: 
    - GraphSEAL (DGCNN): ì„œë¸Œê·¸ë˜í”„ êµ¬ì¡° í•™ìŠµ (Train ì—£ì§€ë§Œ!)
    - SEALDataset: Target edge ë§ˆìŠ¤í‚¹ (ì˜ˆì¸¡ ëŒ€ìƒ ì—£ì§€ ì œê±°)
    - ë²¤ì¹˜ë§ˆí¬: Common Neighbors, Adamic-Adar ë¹„êµ (Test ì—£ì§€)
  ì¶œë ¥: final_hybrid_model_strict.pt
  í‰ê°€: ROC-AUC, Precision@K (Test ì—£ì§€ë¡œë§Œ)

[ê²€ì¦] Data Leakage ì²´í¬ (verify_no_leakage.py) ğŸ†•
  ì…ë ¥: ëª¨ë“  Phase 2~3 ì¶œë ¥ë¬¼
  ì²˜ë¦¬:
    - CHECK 1: Train/Test ì—£ì§€ Overlap í™•ì¸
    - CHECK 2: SEALDataset ì—£ì§€ ë§ˆìŠ¤í‚¹ í™•ì¸
    - CHECK 3: Zero Embedding AUC í…ŒìŠ¤íŠ¸ (< 0.65 = PASS)
    - CHECK 4: Hard Negatives AUC í…ŒìŠ¤íŠ¸ (> 0.65 = PASS)
  ì¶œë ¥: Data Leakage ì§„ë‹¨ ë¦¬í¬íŠ¸

[Phase 4] ê³µê¸‰ë§ ì¬ë°°ì„  (main_phase4.py)
  ì…ë ¥: Phase 2 ì„ë² ë”© + Phase 3 ì˜ˆì¸¡ ì ìˆ˜
  ì²˜ë¦¬: 
    - SupplyChainOptimizer: ì œì•½ ì¡°ê±´ ìµœì í™”
    - TIS ìµœì†Œí™”, ìœ ì‚¬ë„ ìµœëŒ€í™”
  ì¶œë ¥: H_prime_rewired.npz

[Phase 5] ë¦¬ì§ˆë¦¬ì–¸ìŠ¤ ê²€ì¦ (main_phase5.py)
  ì…ë ¥: ì›ë³¸ H + ì¬ë°°ì„  H'
  ì²˜ë¦¬: 
    - ResilienceSimulator: Shock Propagation
    - H vs H' ê²½ì œì  ì†ì‹¤ ë¹„êµ
  ì¶œë ¥: Delta Output, ì‹œê°í™” ê·¸ë˜í”„

# ============================================================
# ë°ì´í„° í¬ê¸° (ì°¸ê³ )
# ============================================================

ë…¸ë“œ(ê¸°ì—…): 438,946ê°œ
ì—£ì§€(ê±°ë˜): ~ìˆ˜ë°±ë§Œ ê°œ
í”¼ì²˜ ì°¨ì›: 197 (ì¬ë¬´4 + ì¢Œí‘œ2 + TIS1 + ì‚°ì—…ë¶„ë¥˜ + ë ˆì‹œí”¼33)
ì„ë² ë”© ì°¨ì›: 32 