# Phase 3: Final Summary
# ======================

## âœ… ì™„ì„±ëœ ê¸°ëŠ¥

### 1. í•µì‹¬ ëª¨ë¸ (Two-Track Hybrid)
- âœ… Track A: SC-TGN (Temporal Graph Network)
  - Memory ê¸°ë°˜ ê³¼ê±° ìƒí˜¸ì‘ìš© ê¸°ì–µ
  - ì‹œê°„ ì¸ì½”ë”© (Cosine í•¨ìˆ˜)
  - GRU ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸

- âœ… Track B: GraphSEAL (Structural Pattern)
  - Sub-graph íŒ¨í„´ í•™ìŠµ (k-hop ì´ì›ƒ)
  - UKGE (Uncertain Knowledge Graph Embedding)
  - TIS ê¸°ë°˜ ì‹ ë¢°ë„ ì ìˆ˜

- âœ… Ensemble
  - í•™ìŠµ ê°€ëŠ¥í•œ ê°€ì¤‘ì¹˜ Î±
  - Confidence-weighted ìµœì¢… ì˜ˆì¸¡

### 2. ì†ì‹¤ í•¨ìˆ˜ (Loss Function)
- âœ… TIS-aware Soft Label BCE
  - Positive: 1.0 - Î± * TIS
  - Negative: 0.0 (ë˜ëŠ” 0.05)

- âœ… Ranking Loss
  - Positive ì ìˆ˜ > Negative ì ìˆ˜ + margin
  - Margin = 0.5

### 3. ë„¤ê±°í‹°ë¸Œ ìƒ˜í”Œë§ (Negative Sampling)
- âœ… Random Negative (50%)
  - ë¬´ì‘ìœ„ ê¸°ì—…ìŒ
  - Self-loop, Positive ì œê±°

- âœ… Historical Negative (50%)
  - ê³¼ê±° ì¡´ì¬í–ˆë˜ ê±°ë˜ (2020-2023)
  - ë” ì–´ë ¤ìš´ ë„¤ê±°í‹°ë¸Œ

### 4. í‰ê°€ ë©”íŠ¸ë¦­ (Evaluation Metrics)
- âœ… Recall@K (K=10, 50, 100, 500, 1000)
  - ì ì¬ ê±°ë˜ ë°œêµ´ ëŠ¥ë ¥

- âœ… MRR (Mean Reciprocal Rank)
  - ë­í‚¹ ì •í™•ë„

- âœ… RMSE (Risk-aware)
  - Overall, Positive, Negative
  - TIS-aware, Confidence-weighted

### 5. ë²¤ì¹˜ë§ˆí¬ ë¹„êµ (Benchmarks)
- âœ… PA (Preferential Attachment)
  - Score = degree(u) * degree(v)

- âœ… RA (Resource Allocation)
  - Score = Î£ 1/degree(common_neighbor)

- âœ… JC (Jaccard Coefficient)
  - Score = |common| / |union|

### 6. ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ (Robustness Test) - ì˜µì…˜
- âœ… Negative ë¹„ìœ¨ ì¦ê°€ (1:1 â†’ 1:4)
- âœ… ì„±ëŠ¥ ë³€í™” ì‹œê°í™”

---

## ğŸ“‚ ìƒì„±ëœ íŒŒì¼

### í•µì‹¬ ëª¨ë“ˆ
```
src/
â”œâ”€â”€ temporal_graph_builder.py       # ì‹œê³„ì—´ ê·¸ë˜í”„ ë°ì´í„° ë¹Œë”
â”œâ”€â”€ sc_tgn.py                        # Track A: SC-TGN
â”œâ”€â”€ graphseal.py                     # Track B: GraphSEAL + UKGE
â”œâ”€â”€ hybrid_trainer.py                # Hybrid í•™ìŠµ (TIS-aware Loss ì ìš©)
â”œâ”€â”€ phase3_loss.py                   # TIS-aware BCE + Ranking Loss
â”œâ”€â”€ negative_sampler_phase3.py       # Random + Historical Negative
â”œâ”€â”€ benchmarks.py                    # PA, RA, JC ë²¤ì¹˜ë§ˆí¬
â”œâ”€â”€ metrics.py                       # MRR, RMSE, Recall@K
â””â”€â”€ robustness_test.py               # ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸
```

### ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
```
main_phase3_hybrid.py                # ì „ì²´ í•™ìŠµ (100 epochs)
quick_test_phase3.py                 # ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (5 epochs)
evaluate_phase3_comprehensive.py     # ì¢…í•© í‰ê°€ + ë²¤ì¹˜ë§ˆí¬
```

### ë¬¸ì„œ
```
PHASE3_README.md                     # ì‚¬ìš© ì„¤ëª…ì„œ
PHASE3_STRUCTURE.txt                 # êµ¬ì¡° ì„¤ëª…
requirements_phase3.txt              # ì˜ì¡´ì„±
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
pip install -r requirements_phase3.txt
```

### 2. ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (5 epochs, 5-10ë¶„)
```bash
python quick_test_phase3.py
```

### 3. ì „ì²´ í•™ìŠµ (100 epochs, 1-2ì‹œê°„)
```bash
python main_phase3_hybrid.py
```

### 4. ì¢…í•© í‰ê°€ + ë²¤ì¹˜ë§ˆí¬ ë¹„êµ
```bash
python evaluate_phase3_comprehensive.py

# ì‹¤í–‰ ì¤‘ ì§ˆë¬¸:
# "ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n)"
# - y: ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ ì¶”ê°€ ì‹¤í–‰ (10-20ë¶„)
# - n: ê±´ë„ˆë›°ê¸°
```

---

## ğŸ“Š ì˜ˆìƒ ì¶œë ¥

### 1. í•™ìŠµ ì™„ë£Œ í›„
```
results/
â”œâ”€â”€ hybrid_model_best.pt             # ìµœê³  ì„±ëŠ¥ ëª¨ë¸
â””â”€â”€ phase3_metrics.npz               # í•™ìŠµ/í‰ê°€ ë©”íŠ¸ë¦­
```

### 2. ì¢…í•© í‰ê°€ ì™„ë£Œ í›„
```
================================================================================
Model           Recall@10    Recall@50    Recall@100   MRR         
================================================================================
GNN (Ours)      0.3245       0.5812       0.7234       0.4123      
PA              0.1234       0.2456       0.3567       0.2012      
RA              0.1567       0.2890       0.4123       0.2345      
JC              0.1423       0.2712       0.3945       0.2198      
================================================================================

ğŸ“Š RMSE (Risk-aware Prediction Error):
----------------------------------------
  - RMSE (Overall): 0.2145
  - RMSE (Positive): 0.1934
  - RMSE (Negative): 0.0234
  - RMSE (TIS-aware): 0.1867
  - RMSE (Confidence-weighted): 0.1789
----------------------------------------
```

### 3. ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ (ì˜µì…˜)
```
ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ ìš”ì•½:
----------------------------------------------------------------------
Neg Ratio    Recall@10    Recall@50    MRR         
----------------------------------------------------------------------
1:1.0        0.3245       0.5812       0.4123      
1:2.0        0.2834       0.5234       0.3789      
1:3.0        0.2512       0.4856       0.3456      
1:4.0        0.2298       0.4523       0.3201      
----------------------------------------------------------------------

ğŸ“Š ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ ê·¸ë˜í”„ ì €ì¥: results/robustness_test.png
```

---

## ğŸ¯ ì£¼ìš” íŠ¹ì§•

### 1. TIS ê¸°ë°˜ Risk-aware Learning
- Positive ì—£ì§€: 1.0 - Î± * TIS (Soft Label)
- TIS ë†’ìŒ â†’ Label ë‚®ì•„ì§ â†’ ëª¨ë¸ì´ ë¶ˆí™•ì‹¤ì„± í•™ìŠµ

### 2. Historical Negative Sampling
- ê³¼ê±° ì¡´ì¬í–ˆë˜ ê±°ë˜ â†’ ë” ì–´ë ¤ìš´ ë„¤ê±°í‹°ë¸Œ
- Random + Historical í˜¼í•© (50:50)

### 3. Two-Track Ensemble
- Track A (TGN): ì‹œê°„ì˜ íë¦„ ë°˜ì˜
- Track B (GraphSEAL): êµ¬ì¡°ì  íŒ¨í„´ ë°˜ì˜
- í•™ìŠµ ê°€ëŠ¥í•œ ê°€ì¤‘ì¹˜ë¡œ ìµœì  ì¡°í•©

### 4. ì¢…í•© í‰ê°€
- GNN vs íœ´ë¦¬ìŠ¤í‹± (PA, RA, JC) ë¹„êµ
- Recall@K, MRR, RMSE ë‹¤ê°ë„ ë¶„ì„
- ê²¬ê³ ì„± í…ŒìŠ¤íŠ¸ (Negative ë¹„ìœ¨ ì¦ê°€)

---

## ğŸ’¡ í•µì‹¬ ìˆ˜ì‹

### ìµœì¢… ì˜ˆì¸¡ í™•ë¥ 
```
P(u, v) = Ïƒ(Logit_hybrid Ã— Confidence)

where:
  Logit_hybrid = Î± Ã— Logit_TGN + (1-Î±) Ã— Logit_GraphSEAL
  Confidence = 1.0 - Î² Ã— TIS(v)
  Î± = Ïƒ(learnable_param)  # í•™ìŠµë¨
```

### Soft Label (TIS-aware)
```
Label_pos = 1.0 - Î± Ã— TIS(v)
Label_neg = 0.0
```

### Loss Function
```
Loss = BCE(Logit, SoftLabel) + Î» Ã— RankingLoss(Logit_pos, Logit_neg)
```

---

## ğŸ” ë‹¤ìŒ ë‹¨ê³„

Phase 3 ì™„ë£Œ í›„:

1. **ì„±ëŠ¥ ë¶„ì„**
   - GNNì´ ë²¤ì¹˜ë§ˆí¬ë³´ë‹¤ ì–¼ë§ˆë‚˜ ì¢‹ì€ê°€?
   - Recall@10 vs Recall@100: Trade-off ë¶„ì„

2. **Track ê¸°ì—¬ë„ ë¶„ì„**
   - Î± ê°’ í™•ì¸ (TGN vs GraphSEAL)
   - ê° Track ë‹¨ë… ì„±ëŠ¥ vs Ensemble ì„±ëŠ¥

3. **UKGE íš¨ê³¼ ë¶„ì„**
   - TIS ë†’ì€ ì—£ì§€ vs ë‚®ì€ ì—£ì§€ ì˜ˆì¸¡ ì •í™•ë„
   - Confidence-weighted RMSE ê°œì„  ì •ë„

4. **ì‹œê³„ì—´ íŒ¨í„´ ë¶„ì„**
   - 2023ë…„ ì˜ˆì¸¡ì´ ì˜/ëª» ë˜ëŠ” ê¸°ì—… íŠ¹ì„±
   - ì–´ë–¤ ì‹œê¸°ì— ì„±ëŠ¥ ë³€í™”?

5. **ì‹¤ì œ ì¶”ì²œ ì‹œìŠ¤í…œ**
   - ìƒìœ„ Kê°œ ì¶”ì²œì„ ë¹„ì¦ˆë‹ˆìŠ¤ì— ì ìš©
   - A/B í…ŒìŠ¤íŠ¸ ì„¤ê³„

---

**ì‘ì„±ì¼**: 2026-01-19  
**ë²„ì „**: 2.0  
**ìƒíƒœ**: âœ… ì™„ë£Œ (Benchmarks + Comprehensive Evaluation í¬í•¨)
